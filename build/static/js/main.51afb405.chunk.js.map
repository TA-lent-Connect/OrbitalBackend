{"version":3,"sources":["components/Module.js","components/Listing.js","components/Notification.js","components/LoginForm.js","components/ListingForm.js","components/Togglable.js","services/listings.js","services/login.js","App.js","index.js"],"names":["Module","module","moduleCode","title","description","Listing","listing","className","Notification","message","LoginForm","handleSubmit","handleUsernameChange","handlePasswordChange","username","password","onSubmit","value","onChange","type","ListingForm","createListing","useState","newListing","setNewListing","event","preventDefault","target","Togglable","props","visible","setVisible","hideWhenVisible","display","showWhenVisible","toggleVisibility","style","onClick","buttonLabel","children","baseUrl","token","axios","get","then","response","data","newObject","config","headers","Authorization","post","newToken","login","credentials","a","App","modules","setModules","newFind","setNewFind","listings","setListings","errorMessage","setErrorMessage","setUsername","setPassword","user","setUser","useEffect","listingService","initialListings","loggedUserJSON","window","localStorage","getItem","JSON","parse","addListing","listingObject","returnedListing","concat","modulesToShow","filter","includes","handleLogin","loginService","setItem","stringify","setTimeout","name","map","myListing","id","ReactDOM","render","document","getElementById"],"mappings":"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","file":"static/js/main.51afb405.chunk.js","sourcesContent":["import React from 'react'\r\n\r\nconst Module = ({ module }) => {\r\n  return (\r\n    <div>\r\n        <p>{module.moduleCode}</p>\r\n        <p>{module.title}</p>\r\n        <p>{module.description}</p>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default Module","import React from 'react'\r\n\r\nconst Listing = ({ listing }) => {\r\n  return (\r\n    <div>\r\n        <li className=\"listing\">{listing.module}</li>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default Listing","import React from 'react'\r\n\r\nconst Notification = ({ message }) => {\r\n  if (message === null) {\r\n    return null\r\n  }\r\n\r\n  return (\r\n    <div className=\"error\">\r\n      {message}\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default Notification","import React from 'react'\r\n\r\nconst LoginForm = ({\r\n   handleSubmit,\r\n   handleUsernameChange,\r\n   handlePasswordChange,\r\n   username,\r\n   password\r\n  }) => {\r\n  return (\r\n    <div>\r\n      <h2>Login</h2>\r\n\r\n      <form onSubmit={handleSubmit}>\r\n        <div>\r\n          username\r\n          <input\r\n            value={username}\r\n            onChange={handleUsernameChange}\r\n          />\r\n        </div>\r\n        <div>\r\n          password\r\n          <input\r\n            type=\"password\"\r\n            value={password}\r\n            onChange={handlePasswordChange}\r\n          />\r\n      </div>\r\n        <button type=\"submit\">login</button>\r\n      </form>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default LoginForm","import React, {useState} from 'react' \r\n\r\nconst ListingForm = ({ createListing }) => {\r\n  const [newListing, setNewListing] = useState('')\r\n\r\n  const handleListingChange = (event) => {\r\n    setNewListing(event.target.value)\r\n  }\r\n\r\n  const addListing = (event) => {\r\n    event.preventDefault()\r\n    createListing({\r\n      module: newListing\r\n    })\r\n\r\n    setNewListing('')\r\n  }\r\n\r\n  return (\r\n    <div>\r\n      <h2>Create a new Listing</h2>\r\n\r\n      <form onSubmit={addListing}>\r\n        <input\r\n          value={newListing}\r\n          onChange={handleListingChange}\r\n        />\r\n        <button type=\"submit\">save</button>\r\n      </form>  \r\n    </div>\r\n  )\r\n}\r\n\r\nexport default ListingForm","import React, { useState } from 'react'\r\n\r\nconst Togglable = (props) => {\r\n  const [visible, setVisible] = useState(false)\r\n\r\n  const hideWhenVisible = { display: visible ? 'none' : '' }\r\n  const showWhenVisible = { display: visible ? '' : 'none' }\r\n\r\n  const toggleVisibility = () => {\r\n    setVisible(!visible)\r\n  }\r\n\r\n  return (\r\n    <div>\r\n      <div style={hideWhenVisible}>\r\n        <button onClick={toggleVisibility}>{props.buttonLabel}</button>\r\n      </div>\r\n      <div style={showWhenVisible}>\r\n        {props.children}\r\n        <button onClick={toggleVisibility}>cancel</button>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default Togglable","import axios from 'axios'\r\nconst baseUrl = '/api/listings'\r\n\r\nlet token = null\r\n\r\nconst setToken = newToken => {\r\n  token = `bearer ${newToken}`\r\n}\r\n\r\nconst getAll = () => {\r\n  const request = axios.get(baseUrl)\r\n  return request.then(response => response.data)\r\n  \r\n}\r\n\r\nconst create = newObject => {\r\n  const config = {\r\n    headers: { Authorization: token },\r\n  }\r\n  const request = axios.post(baseUrl, newObject, config)\r\n  return request.then(response => response.data)\r\n}\r\n\r\nconst update = (id, newObject) => {\r\n  const request = axios.put(`${baseUrl}/${id}`, newObject)\r\n  return request.then(response => response.data)\r\n}\r\n\r\nexport default { getAll, create, update, setToken }","import axios from 'axios'\r\nconst baseUrl = '/api/login'\r\n\r\nconst login = async credentials => {\r\n  const response = await axios.post(baseUrl, credentials)\r\n  return response.data\r\n}\r\n\r\nexport default { login }","import React, { useState, useEffect } from 'react'\r\nimport axios from 'axios'\r\nimport Module from './components/Module'\r\nimport Listing from './components/Listing'\r\nimport Notification from './components/Notification'\r\nimport LoginForm from './components/LoginForm'\r\nimport ListingForm from './components/ListingForm'\r\nimport Togglable from './components/Togglable'\r\nimport listingService from './services/listings'\r\nimport loginService from './services/login' \r\n\r\nconst App = () => {\r\n  const [modules, setModules] = useState([]);\r\n  const [newFind, setNewFind] = useState('')\r\n  const [listings, setListings] = useState([])\r\n\r\n  const [errorMessage, setErrorMessage] = useState(null)\r\n\r\n  const [username, setUsername] = useState('') \r\n  const [password, setPassword] = useState('') \r\n\r\n  const [user, setUser] = useState(null)\r\n\r\n  useEffect(() => {\r\n    axios\r\n      .get('https://api.nusmods.com/v2/2020-2021/moduleInfo.json')\r\n      .then(response => {\r\n        setModules(response.data)\r\n      })\r\n  }, [])\r\n\r\n  useEffect(() => {\r\n    listingService\r\n      .getAll()\r\n      .then(initialListings => {\r\n      setListings(initialListings)\r\n    })\r\n  }, [])\r\n\r\n  useEffect(() => {\r\n    const loggedUserJSON = window.localStorage.getItem('loggedUser')\r\n    if (loggedUserJSON) {\r\n      const user = JSON.parse(loggedUserJSON)\r\n      setUser(user)\r\n      listingService.setToken(user.token)\r\n    }\r\n  }, [])  \r\n\r\n  const addListing = (listingObject) => {\r\n    listingService\r\n      .create(listingObject)\r\n      .then(returnedListing => {\r\n        setListings(listings.concat(returnedListing))\r\n      })\r\n  }\r\n\r\n  const handleFindChange = (event) => {\r\n    setNewFind(event.target.value)\r\n  }\r\n\r\n  const modulesToShow = modules.filter(module => {\r\n    return module.moduleCode.includes(newFind)\r\n  })\r\n\r\n  const handleUsernameChange = (event) => {\r\n    setUsername(event.target.value)\r\n  }\r\n\r\n  const handlePasswordChange = (event) => {\r\n    setPassword(event.target.value)\r\n  }\r\n\r\n  const handleLogin = async (event) => {\r\n    event.preventDefault()\r\n    try {\r\n      const user = await loginService.login({\r\n        username, password,\r\n      })\r\n      listingService.setToken(user.token)\r\n      window.localStorage.setItem(\r\n        'loggedUser', JSON.stringify(user)\r\n      ) \r\n      setUser(user)\r\n      setUsername('')\r\n      setPassword('')\r\n    } catch (exception) {\r\n      setErrorMessage('Wrong credentials')\r\n      setTimeout(() => {\r\n        setErrorMessage(null)\r\n      }, 5000)\r\n    }\r\n  }\r\n\r\n  const loginForm = () => (\r\n    <Togglable buttonLabel=\"log in\">\r\n      <LoginForm\r\n        username={username}\r\n        password={password}\r\n        handleUsernameChange={handleUsernameChange}\r\n        handlePasswordChange={handlePasswordChange}\r\n        handleSubmit={handleLogin}\r\n      />\r\n    </Togglable>   \r\n  )\r\n\r\n  const listingForm = () => (\r\n    <Togglable buttonLabel=\"new listing\">\r\n      <ListingForm\r\n        createListing={addListing}\r\n      />\r\n    </Togglable>\r\n  )\r\n\r\n  return (\r\n    <div>\r\n      <Notification message={errorMessage} />\r\n      {user === null ?\r\n        loginForm() :\r\n        <div>\r\n          <p>{user.name} logged in</p>\r\n          <h1>My Listings</h1>\r\n          <ul>\r\n            {listings.filter(listing => {\r\n              return listing.user.username === user.username\r\n            }).map(myListing => \r\n              <Listing key={myListing.id} listing={myListing} />\r\n            )}\r\n          </ul>\r\n          {listingForm()}\r\n        </div>\r\n      }\r\n      <h1>Current Listings</h1>\r\n        <ul>\r\n          {listings.map(listing => \r\n            <Listing key={listing.id} listing={listing} />\r\n          )}\r\n        </ul>\r\n      <h1>Modules</h1>\r\n      <form>\r\n        <label>\r\n          find modules:\r\n          <input\r\n            value={newFind}\r\n            onChange={handleFindChange}\r\n          />\r\n        </label>\r\n      </form>\r\n      <div>\r\n        {modulesToShow.map(module => \r\n            <Module key={module.moduleCode} module={module} />\r\n        )}\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default App;\r\n","import ReactDOM from 'react-dom'\r\nimport App from './App'\r\n\r\nReactDOM.render(\r\n  <App />,\r\n  document.getElementById('root')\r\n)\r\n"],"sourceRoot":""}